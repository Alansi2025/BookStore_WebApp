<!DOCTYPE html>
<html lang="en" class="">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Search | BookStream</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .dark body { background-color: #0f172a; color: #f8fafc; }
    </style>
</head>
<body class="antialiased bg-slate-50 dark:bg-slate-900 text-slate-800 dark:text-slate-200">

    <header class="sticky top-0 z-40 w-full backdrop-blur-md bg-white/70 dark:bg-slate-900/70 border-b border-slate-200 dark:border-slate-800">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8 flex items-center justify-between h-16">
            <a href="index.html" class="text-2xl font-extrabold text-blue-500">BookStream</a>
            <nav class="hidden md:flex items-center space-x-6 text-sm font-semibold">
                <a href="index.html" class="hover:text-blue-500">Home</a>
                <a href="search.html" class="text-blue-500">Search</a>
                <a href="library.html" class="hover:text-blue-500">My Library</a>
                <a href="about.html" class="hover:text-blue-500">About</a>
            </nav>
            </div>
    </header>

    <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-12">
        <section class="max-w-3xl mx-auto text-center">
            <h1 class="text-4xl font-extrabold mb-4">Search for a Book</h1>
            <p class="text-slate-600 dark:text-slate-400 mb-6">Discover your next read from a massive collection of books.</p>
            <div class="flex gap-2">
                <input type="text" id="search-input" placeholder="Search by title, author, or ISBN..." class="w-full px-4 py-2 rounded-md bg-white dark:bg-slate-800 border border-slate-300 dark:border-slate-700 focus:ring-2 focus:ring-blue-500 outline-none">
                <button id="search-btn" class="bg-blue-500 text-white px-6 py-2 rounded-md font-bold hover:bg-blue-600 transition">Search</button>
            </div>
        </section>

        <section id="results-container" class="mt-12">
            <p id="status-message" class="text-center text-slate-500">Search results will appear here.</p>
            <div id="search-results" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-6">
                </div>
        </section>
    </main>
      <!-- Footer -->
  <footer class="bg-slate-100 dark:bg-slate-900/50 border-t border-slate-200 dark:border-slate-800">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-12">
      <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
        <div class="col-span-1">
          <h3 class="text-2xl font-extrabold text-blue-500 mb-2">BookStream</h3>
          <p class="text-sm text-slate-500 dark:text-slate-400">&copy; 2025. All Rights Reserved.</p>
        </div>
        <div>
          <h4 class="font-bold mb-3">Navigate</h4>
          <ul class="space-y-2 text-sm text-slate-600 dark:text-slate-300">
            <li><a href="index.html" class="hover:text-blue-500">Home</a></li>
            <li><a href="index.html" class="hover:text-blue-500">Genres</a></li>
            <li><a href="new-releases.html" class="hover:text-blue-500">New Releases</a></li>
            <li><a href="new-releases.html" class="hover:text-blue-500">Bestsellers</a></li>
          </ul>
        </div>
        <div>
          <h4 class="font-bold mb-3">About</h4>
          <ul class="space-y-2 text-sm text-slate-600 dark:text-slate-300">
            <li><a href="about.html" class="hover:text-blue-500">About Us</a></li>
            <li><a href="about.html" class="hover:text-blue-500">Contact Us</a></li>
            <li><a href="about.html" class="hover:text-blue-500">Privacy Policy</a></li>
            <li><a href="about.html" class="hover:text-blue-500">Terms of Service</a></li>
          </ul>
        </div>
        <div>
          <h4 class="font-bold mb-3">Connect</h4>
          <div class="flex space-x-4">
             <a href="#" class="text-slate-500 hover:text-blue-500"><svg class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24"><path d="M22.46,6C21.69,6.35 20.86,6.58 20,6.69C20.88,6.16 21.56,5.32 21.88,4.31C21.05,4.81 20.13,5.16 19.16,5.36C18.37,4.5 17.26,4 16,4C13.65,4 11.73,5.92 11.73,8.29C11.73,8.63 11.77,8.96 11.84,9.27C8.28,9.09 5.11,7.38 3,4.79C2.63,5.42 2.42,6.16 2.42,6.94C2.42,8.43 3.17,9.75 4.33,10.5C3.62,10.5 2.96,10.3 2.38,10C2.38,10 2.38,10 2.38,10.03C2.38,12.11 3.86,13.85 5.82,14.24C5.46,14.34 5.08,14.39 4.69,14.39C4.42,14.39 4.15,14.36 3.89,14.31C4.43,16 6,17.26 7.89,17.29C6.43,18.45 4.58,19.13 2.56,19.13C2.22,19.13 1.88,19.11 1.54,19.07C3.44,20.29 5.7,21 8.12,21C16,21 20.33,14.46 20.33,8.79C20.33,8.6 20.33,8.42 20.32,8.23C21.16,7.63 21.88,6.87 22.46,6Z" /></svg></a>
             <a href="#" class="text-slate-500 hover:text-blue-500"><svg class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24"><path d="M12,2A10,10 0 0,0 2,12C2,16.42 4.87,20.17 9,21.5C9.08,21.5 9.12,21.45 9.12,21.37V19.35C7.2,19.72 6.7,18.55 6.55,18.05C6.45,17.75 6,17.15 5.5,16.9C5,16.65 4.5,16.2 5.5,16.2C6.4,16.2 6.8,17.1 7,17.35C7.9,18.85 9.5,18.4 10.1,18.15C10.2,17.5 10.45,17.1 10.7,16.85C8.35,16.6 5.85,15.6 5.85,11.95C5.85,10.85 6.2,9.95 6.8,9.25C6.7,9 6.4,8.1 6.9,6.7C6.9,6.7 7.75,6.45 9.1,7.4C9.9,7.2 10.75,7.05 11.6,7.05C12.45,7.05 13.3,7.2 14.1,7.4C15.45,6.45 16.3,6.7 16.3,6.7C16.8,8.1 16.5,9 16.4,9.25C17,9.95 17.35,10.85 17.35,11.95C17.35,15.6 14.85,16.6 12.5,16.85C12.85,17.15 13.15,17.75 13.15,18.6V21.37C13.15,21.45 13.2,21.5 13.28,21.5C17.41,20.17 20.28,16.42 20.28,12A10,10 0 0,0 12,2Z" /></svg></a>
          </div>
        </div>
      </div>
    </div>
  </footer>


    <script>
        const searchInput = document.getElementById('search-input');
        const searchBtn = document.getElementById('search-btn');
        const searchResultsContainer = document.getElementById('search-results');
        const statusMessage = document.getElementById('status-message');

        // Function to search books using Google Books API
        const searchBooks = async () => {
            const query = searchInput.value.trim();
            if (!query) {
                statusMessage.textContent = 'Please enter a search term.';
                return;
            }

            statusMessage.textContent = 'Searching...';
            searchResultsContainer.innerHTML = '';

            try {
                const response = await fetch(`https://www.googleapis.com/books/v1/volumes?q=${encodeURIComponent(query)}&maxResults=20`);
                if (!response.ok) throw new Error('Network response was not ok');
                
                const data = await response.json();

                if (!data.items || data.items.length === 0) {
                    statusMessage.textContent = `No books found for "${query}".`;
                    return;
                }
                
                statusMessage.textContent = ''; // Clear status message
                displayResults(data.items);

            } catch (error) {
                console.error('Fetch error:', error);
                statusMessage.textContent = 'Failed to fetch books. Please try again.';
            }
        };

        // Function to display results on the page
        const displayResults = (books) => {
            searchResultsContainer.innerHTML = books.map(book => {
                const info = book.volumeInfo;
                const id = book.id;
                const title = info.title ?? 'No Title';
                const author = info.authors ? info.authors[0] : 'Unknown Author';
                // Use optional chaining (?.) for safety if imageLinks or thumbnail is missing
                const cover = info.imageLinks?.thumbnail ?? 'https://placehold.co/128x192/1e293b/f8fafc?text=No+Cover';
                
                // Prepare a simplified book object for saving
                const bookData = { id, title, author, cover };

                return `
                    <div class="text-center">
                        <img src="${cover}" alt="${title}" class="w-full aspect-[2/3] object-cover rounded-md shadow-lg mb-2">
                        <h3 class="font-bold text-sm">${title}</h3>
                        <p class="text-xs text-slate-500">${author}</p>
                        <button 
                            onclick='saveToLibrary(${JSON.stringify(bookData)})'
                            class="mt-2 text-xs bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200 px-3 py-1 rounded-full hover:bg-blue-200 transition">
                            Save to Library
                        </button>
                    </div>
                `;
            }).join('');
        };
        
        // Function to save a book to the library using localStorage
        const saveToLibrary = (bookData) => {
            // Get current library from localStorage or create an empty array
            let library = JSON.parse(localStorage.getItem('bookLibrary') || '[]');
            
            // Check if book already exists
            if (library.some(book => book.id === bookData.id)) {
                alert('This book is already in your library!');
                return;
            }
            
            // Add the new book and save back to localStorage
            library.push(bookData);
            localStorage.setItem('bookLibrary', JSON.stringify(library));
            alert(`"${bookData.title}" has been saved to your library!`);
        };
        
        searchBtn.addEventListener('click', searchBooks);
        searchInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') {
                searchBooks();
            }
        });
    </script>
</body>
</html>